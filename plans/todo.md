üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ë–∞–∑–æ–≤—ã–π Auth –¥–ª—è Traefik Dashboard –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**

   –ü—Ä–æ–±–ª–µ–º–∞:
   - Traefik Dashboard –∑–∞—â–∏—â—ë–Ω Basic Auth —Å credentials `test:test`
   - –≠—Ç–æ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è production

   –§–∞–π–ª—ã:
   - `compose/compose.yml` ‚Äî labels –¥–ª—è middleware auth

   –†–∏—Å–∫: –ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ dashboard Traefik

   –†–µ—à–µ–Ω–∏–µ:
   ```bash
   # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —Ö–µ—à
   htpasswd -nb username password | sed -e s/\\$/\\$\\$/g

   # –ó–∞–º–µ–Ω–∏—Ç—å –≤ compose/compose.yml:
   traefik.http.middlewares.auth.basicauth.users=username:$apr1$hash...
   ```

---

2. **.env —Ñ–∞–π–ª –Ω–µ –±—ç–∫–∞–ø–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**

   –ü—Ä–æ–±–ª–µ–º–∞:
   - `backup.sh` –∏—Å–∫–ª—é—á–∞–µ—Ç .env –∏–∑ –±—ç–∫–∞–ø–∞
   - –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Å–µ–∫—Ä–µ—Ç—ã
   - –ù–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –ø–æ —Ö—Ä–∞–Ω–µ–Ω–∏—é .env –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ

   –†–∏—Å–∫: –ü–æ–ª–Ω–∞—è –ø–æ—Ç–µ—Ä—è –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏–∑ –±—ç–∫–∞–ø–∞

   –†–µ—à–µ–Ω–∏–µ:
   1. –°–æ–∑–¥–∞—Ç—å `compose/.env.template` –±–µ–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤
   2. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ —Ö—Ä–∞–Ω–µ–Ω–∏—é —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ password manager
   3. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –±—ç–∫–∞–ø .env —Å –ø–æ–º–æ—â—å—é GPG

---

3. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±—ç–∫–∞–ø–æ–≤**

   –ü—Ä–æ–±–ª–µ–º–∞:
   - Systemd timer'—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É–∑–Ω–∞—Ç—å –æ failed –±—ç–∫–∞–ø–µ
   - `backup.sh` –ø–∏—à–µ—Ç –ª–æ–≥ —Ç–æ–ª—å–∫–æ –≤ —Ñ–∞–π–ª

   –§–∞–π–ª—ã:
   - `systemd/homelab-backup-*.timer` ‚Äî –Ω–µ—Ç OnFailure=

   –†–∏—Å–∫: –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–∏–µ –±—ç–∫–∞–ø—ã –æ–±–Ω–∞—Ä—É–∂–∞—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏

   –†–µ—à–µ–Ω–∏–µ:
   ```ini
   # –î–æ–±–∞–≤–∏—Ç—å –≤ systemd unit
   [Service]
   OnFailure=notify-backup-failed@%n.service
   ```

---

‚ö†Ô∏è –°–µ—Ä—å—ë–∑–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ resource limits –¥–ª—è Traefik**

   –ü—Ä–æ–±–ª–µ–º–∞:
   Traefik –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

   –§–∞–π–ª: `compose/compose.yml`

   –†–∏—Å–∫: Traefik –º–æ–∂–µ—Ç —É—Ä–æ–Ω–∏—Ç—å –≤–µ—Å—å —Å–µ—Ä–≤–µ—Ä (OOM)

   –†–µ—à–µ–Ω–∏–µ:
   ```yaml
   services:
     traefik:
       deploy:
         resources:
           limits:
             cpus: '1.0'
             memory: 512M
           reservations:
             cpus: '0.25'
             memory: 128M
   ```

---

5. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**

   –ü—Ä–æ–±–ª–µ–º–∞:
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Ä—É—á–Ω–æ–µ (`operations.md`)
   - –ù–µ—Ç security scanning
   - –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –æ–±—Ä–∞–∑—ã —Å —É—è–∑–≤–∏–º–æ—Å—Ç—è–º–∏

   –†–∏—Å–∫: –ó–∞–ø—É—Å–∫ —É—è–∑–≤–∏–º—ã—Ö –≤–µ—Ä—Å–∏–π

   –†–µ—à–µ–Ω–∏–µ:
   - –î–æ–±–∞–≤–∏—Ç—å Watchtower –∏–ª–∏ ouroboros –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
   - –ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å monthly maintenance –≤ systemd timer
   - –î–æ–±–∞–≤–∏—Ç—å trivy –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤

---

6. **–ù–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö**

   –ü—Ä–æ–±–ª–µ–º–∞:
   ```bash
   # validate.sh:65
   if [ ! -f "compose/.env" ]; then
       if [ -f "compose/.env.example" ]; then
           cp compose/.env.example compose/.env.temp
           mv compose/.env.temp compose/.env  # ‚Üê Race condition!
   ```

   –§–∞–π–ª: `scripts/validate.sh:68`

   –†–∏—Å–∫: –ü–æ—Ç–µ—Ä—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ .env –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ

   –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å mktemp –∏–ª–∏ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

---

7. **restore_test.sh —Ç—Ä–µ–±—É–µ—Ç jq –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏**

   –ü—Ä–æ–±–ª–µ–º–∞:
   ```bash
   # restore_test.sh:95
   LATEST_SNAPSHOT=$(restic list snapshots --json | jq -r '...')
   ```

   –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ jq —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

   –§–∞–π–ª: `scripts/restore_test.sh:95`

   –†–∏—Å–∫: –ö—Ä–∏–ø—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ jq

   –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞

---

8. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±—ç–∫–∞–ø-–¥–∏—Å–∫–∞**

   –ü—Ä–æ–±–ª–µ–º–∞:
   `backup.sh` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –ª–∏ backup disk –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

   –§–∞–π–ª: `scripts/backup.sh`

   –†–∏—Å–∫: –ë—ç–∫–∞–ø –Ω–∞ –∫–æ—Ä–µ–Ω—å –¥–∏—Å–∫–∞ –≤–º–µ—Å—Ç–æ –≤–Ω–µ—à–Ω–µ–≥–æ –¥–∏—Å–∫–∞

   –†–µ—à–µ–Ω–∏–µ:
   ```bash
   # –î–æ–±–∞–≤–∏—Ç—å –≤ backup.sh
   if ! mountpoint -q "$RESTIC_REPO"; then
       error "Backup repository not mounted!"
       exit 1
   fi
   ```

---

üîß –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

9. **Hardcoded –ø—É—Ç–∏ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö**

   –ü—Ä–æ–±–ª–µ–º–∞:
   ```bash
   # deploy.sh:40
   docker compose --env-file compose/.env -f compose/compose.yml down
   ```

   –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –ø—É—Ç–µ–π

   –†–µ—à–µ–Ω–∏–µ: –í—ã–Ω–µ—Å—Ç–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

---

10. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ network policies**

    –ü—Ä–æ–±–ª–µ–º–∞:
    - Traefik –≤ —Å–µ—Ç—è—Ö internal –∏ public
    - –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π communication –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

    –§–∞–π–ª: `compose/compose.yml`

    –†–∏—Å–∫: –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ –¥–∞—Å—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º

    –†–µ—à–µ–Ω–∏–µ: –†–∞–∑–¥–µ–ª–∏—Ç—å —Å–µ—Ç–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø —Å–µ—Ä–≤–∏—Å–æ–≤

---

11. **Traefik –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Let's Encrypt –¥–ª—è HTTPS**

    –ü—Ä–æ–±–ª–µ–º–∞:
    Traefik –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è HTTP (–ø–æ—Ä—Ç 80), HTTPS (443) –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

    –§–∞–π–ª: `compose/traefik/traefik.yml` ‚Äî certificatesResolvers –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω

    –†–∏—Å–∫: –°–µ—Ä–≤–∏—Å—ã –ø–µ—Ä–µ–¥–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ

    –†–µ—à–µ–Ω–∏–µ:
    - –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å certificatesResolvers –≤ traefik.yml
    - –î–æ–±–∞–≤–∏—Ç—å certResolver labels –∫ routers –≤ compose.yml

---

12. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞**

    –ü—Ä–æ–±–ª–µ–º–∞:
    –ù–∏–≥–¥–µ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ –ø–µ—Ä–µ–¥ –±—ç–∫–∞–ø–æ–º

    –†–∏—Å–∫: Failed –±—ç–∫–∞–ø—ã –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–º –¥–∏—Å–∫–µ

    –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤ backup.sh

---

13. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç rate limiting –≤ Traefik**

    –ü—Ä–æ–±–ª–µ–º–∞:
    –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç brute-force –Ω–∞ dashboard

    –§–∞–π–ª: `compose/traefik/dynamic.yml`

    –†–∏—Å–∫: –ü–æ–¥–±–æ—Ä –ø–∞—Ä–æ–ª–µ–π –∫ dashboard

    –†–µ—à–µ–Ω–∏–µ:
    –î–æ–±–∞–≤–∏—Ç—å middleware rate limiting –≤ dynamic.yml

---

üìù –ú–µ–ª–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —É–ª—É—á—à–µ–Ω–∏—è

14. **–ù–µ–ø–æ–ª–Ω—ã–π .gitignore**

    –§–∞–π–ª: `.gitignore`

    –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:
    - `compose/.env.local`
    - `compose/.env.production`
    - `*.bak`

---

15. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CI/CD –≤–∞–ª–∏–¥–∞—Ü–∏–∏**

    –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ PR'–æ–≤ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤

    –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–∏—Ç—å pre-commit hook –∏–ª–∏ GitHub Actions

---

16. **healthcheck.sh –∏—Å–ø–æ–ª—å–∑—É–µ—Ç BASE_URL –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏**

    –§–∞–π–ª: `scripts/healthcheck.sh:64`

    –ï—Å–ª–∏ BASE_URL –Ω–µ –∑–∞–¥–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è localhost (–º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å)

---

17. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**

    –ù–µ—Ç —É–∫–∞–∑–∞–Ω–∏—è –≤–µ—Ä—Å–∏–π Traefik –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

    –ü—Ä–∏–º–µ—Ä: –í `docs/01_repo_overview.md` –Ω–µ —É–∫–∞–∑–∞–Ω–∞ –≤–µ—Ä—Å–∏—è Traefik

---

18. **–ù–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ**

    - `homelab-backup-local` vs `homelab-restore-test` (–±–µ–∑ —Å—É—Ñ—Ñ–∏–∫—Å–∞)

---

19. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö**

    –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫ –Ω–∞–ª–∏—á–∏—è docker, restic, curl, jq

---

20. **Traefik dashboard –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ —Å–µ—Ç–∏**

    –ü—Ä–æ–±–ª–µ–º–∞:
    Dashboard –Ω–∞ –ø–æ—Ä—Ç—É 8080 –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏

    –†–∏—Å–∫: –î–æ—Å—Ç—É–ø –∫ dashboard –∏–∑ —Å–µ—Ç–∏

    –†–µ—à–µ–Ω–∏–µ:
    - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —Å localhost —á–µ—Ä–µ–∑ firewall
    - –ò–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å dashboard –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

---

21. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç graceful shutdown**

    –ù–µ—Ç timeout –∏ stop_grace_period –≤ compose

---

22. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ restore**

    `restore_test.sh` –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é

    –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–∏—Ç—å –≤ systemd monthly timer

---

23. **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞**

    –Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫ —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

    –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π backup –∫–∞–∫ primary
