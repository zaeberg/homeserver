# =============================================================================
# Homeserver Environment Configuration
# =============================================================================
# Это шаблон файла переменных окружения. Скопируйте его в .env и заполните:
#   cp compose/.env.example compose/.env
#   chmod 600 compose/.env
#   nano compose/.env
#
# ⚠️ ВАЖНО: Никогда не коммитьте .env файл в git! Он содержит секреты.
# =============================================================================

# -----------------------------------------------------------------------------
# Базовая конфигурация
# -----------------------------------------------------------------------------

# Базовый URL для доступа к сервисам (обязательный)
# Используется для:
#   - Traefik dashboard routing
#   - Healthcheck endpoints
#   - Различных internal redirects
#
# Формат: http://hostname или http://IP
# Примеры:
#   - http://home.local         (mDNS/Bonjour)
#   - http://192.168.1.100      (статический IP)
#   - http://homeserver.lan     (локальный DNS)
BASE_URL=http://home.local

# -----------------------------------------------------------------------------
# Restic Backup Configuration
# -----------------------------------------------------------------------------
# Restic — это инструмент для дедуплицированных бэкапов с шифрованием.
# См. docs/04_backup_restore.md для подробной настройки.
# -----------------------------------------------------------------------------

# -------------------------------------------------------------------------
# Пароль для шифрования бэкапов (ОБЯЗАТЕЛЬНЫЙ!)
# -------------------------------------------------------------------------
# ⚠️ КРИТИЧНО: Сохраните этот пароль в надёжном месте (password manager)!
# ⚠️ БЕЗ ПАРОЛЯ ВОССТАНОВЛЕНИЕ БЭКАПА НЕВОЗМОЖНО!
# ⚠️ Ротация пароля требует создания нового репозитория (сложно)!
#
# Требования:
#   - Минимум 12 символов (рекомендуется 20+)
#   - Используйте парольную фразу (passphrase) для лучшей запоминаемости
#   - Пример: "correct-horse-battery-staple-42-chars"
#
# Генерация случайного пароля:
#   - Linux: openssl rand -base64 24
#   - macOS: openssl rand -base64 24
#   - Или используйте password manager (Bitwarden, 1Password, etc.)
RESTIC_PASSWORD=CHANGE_THIS_TO_SECURE_PASSWORD

# -------------------------------------------------------------------------
# Локальный репозиторий (ОПЦИОНАЛЬНЫЙ)
# -------------------------------------------------------------------------
# Путь к локальному backup disk (внешний HDD, NAS, etc.)
# Оставьте пустым, если не используете локальные бэкапы.
#
# Требования:
#   - Disk должен быть смонтирован перед запуском backup.sh
#   - Рекомендуется добавить в /etc/fstab для автоподключения
#   - Проверьте монтирование: df -h | grep /mnt/backup
#
# Примеры:
#   - /mnt/backup/restic           (внешний USB disk)
#   - /mnt/nas/homeserver/restic   (NAS mount)
#   - ""                           (не использовать)
RESTIC_REPO_LOCAL=/mnt/backup/restic

# -------------------------------------------------------------------------
# Облачный репозиторий (ОПЦИОНАЛЬНЫЙ)
# -------------------------------------------------------------------------
# Облачное хранилище через rclone (Яндекс Диск, Google Drive, Dropbox, etc.)
# Оставьте пустым, если не используете облачные бэкапы.
#
# Формат: rclone:<remote>:<path>
#
# Настройка rclone:
#   1. Установить rclone: sudo apt install rclone
#   2. Настроить remote: rclone config
#   3. Проверить: rclone ls yandex:homelab-backups
#
# Поддерживаемые сервисы:
#   - Яндекс Диск:   rclone:yandex:homelab-backups
#   - Google Drive:  rclone:gdrive:homelab-backups
#   - Dropbox:       rclone:dropbox:homelab-backups
#   - OneDrive:      rclone:onedrive:homelab-backups
#   - S3:            rclone:s3:bucket-name
#
# Примеры:
#   - rclone:yandex:homelab-backups   (Яндекс Диск)
#   - rclone:gdrive:backups           (Google Drive)
#   - ""                               (не использовать)
RESTIC_REPO_CLOUD=rclone:yandex:homelab-backups

# -----------------------------------------------------------------------------
# Additional Backup Settings
# -----------------------------------------------------------------------------

# -------------------------------------------------------------------------
# Что бэкапить (ОБЯЗАТЕЛЬНЫЙ)
# -------------------------------------------------------------------------
# Путь(и) к файлам и директориям для бэкапа, разделённые пробелами.
#
# Рекомендуется бэкапить:
#   - /srv/homelab/homelab-server  (конфиги, скрипты, compose files)
#   - /srv/data/<service>          (данные сервисов, если критично)
#
# Примеры:
#   - /srv/homelab/homelab-server                              (только конфиги)
#   - "/srv/homelab/homelab-server /srv/data/nginx"            (конфиги + данные)
#   - "/srv/homelab/homelab-server /srv/data/*"                (конфиги + ВСЕ данные)
#
# ⚠️ ВАЖНО: Используйте кавычки если путей несколько!
BACKUP_TARGETS="/srv/homelab/homelab-server"

# -------------------------------------------------------------------------
# Retention Policy (ОПЦИОНАЛЬНЫЙ)
# -------------------------------------------------------------------------
# Политика удержания старых бэкапов (автоматическое удаление).
# Оставьте пустым для использования значений по умолчанию.
#
# По умолчанию (если не указано):
#   --keep-daily 7      # Оставлять последние 7 дневных бэкапов
#   --keep-weekly 4     # Оставлять последние 4 недельных бэкапа
#   --keep-monthly 6    # Оставлять последние 6 месячных бэкапов
#
# Примеры:
#   - --keep-daily 7 --keep-weekly 4 --keep-monthly 6     (по умолчанию)
#   - --keep-daily 14 --keep-weekly 8 --keep-monthly 12   (более длительное)
#   - --keep-daily 30 --keep-monthly 12                  (только daily + monthly)
#
# ⚠️ ВАЖНО: Больше бэкапов = больше место на диске!
# RESTIC_RETENTION=--keep-daily 7 --keep-weekly 4 --keep-monthly 6

# =============================================================================
# Future Settings (заготовки для будущего использования)
# =============================================================================

# -----------------------------------------------------------------------------
# Let's Encrypt Configuration (будущее)
# -----------------------------------------------------------------------------
# Email для уведомлений об истечении сертификатов (когда будет настроен HTTPS)
# LETSENCRYPT_EMAIL=your-email@example.com

# -----------------------------------------------------------------------------
# Database Credentials (будущее)
# -----------------------------------------------------------------------------
# При добавлении баз данных (PostgreSQL, MySQL, etc.)
# DB_PASSWORD=change-this
# DB_ROOT_PASSWORD=change-this-too

# -----------------------------------------------------------------------------
# Application Secrets (будущее)
# -----------------------------------------------------------------------------
# При добавлении приложений с API keys, JWT secrets, etc.
# VAULTWARDEN_ADMIN_TOKEN=generate-random-token
# GRAFANA_ADMIN_PASSWORD=generate-secure-password

# =============================================================================
# Проверка конфигурации
# =============================================================================
# После заполнения .env проверьте конфигурацию:
#
# 1. Проверить, что файл существует:
#    ls -la compose/.env
#
# 2. Проверить права доступа (должен быть 600):
#    chmod 600 compose/.env
#    ls -la compose/.env
#
# 3. Проверить, что пароль задан:
#    grep RESTIC_PASSWORD compose/.env
#
# 4. Проверить, что репозитории смонтированы/доступны:
#    df -h | grep /mnt/backup    (для локального)
#    rclone ls yandex:homelab-backups  (для облачного)
#
# 5. Запустить валидацию:
#    ./scripts/validate.sh
#
# 6. Протестировать бэкап (перед автоматическим запуском):
#    ./scripts/backup.sh local
#    ./scripts/restore_test.sh local
# =============================================================================
